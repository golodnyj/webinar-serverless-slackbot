# Шаг 5. Реализуем функцию Slack-бот

# Шаг 5.1. Создаем функцию

Перейдите в каталог и выберете сервис Cloud Functions. Нажмите кнопку `Создать функцию`.
Задайте имя `for-slack-bot-small-talk`.
Выберете среду выполнения `python37`.

Создайте файл `requirements.txt`. Поменяйте содержимое файлов `requirements.txt` и `index.py` в консоле на содержание аналогичных файлов из текущего каталога. Укажите точку входа `index.handler`. Увеличте таймаут до 5 секунд.

Обязательно укажите сервисный аккаунт, и переменные `SLACK_BOT_TOKEN`, `SLACK_SIGNING_SECRET` полученные ранее. Нажмите кнопку — `Создать версию`.
Запомните идентификатор вашей функции.

# Шаг 5.2. Внесите изменения в API Gateway

Перейдите в каталог и выберете сервис API Gateway. Выберете `for-slack-bot` и начните его редактирование. В секции `/` замените `<IDYOURFUNCTIONSMALLTALK>` на id созданной функции, как в файле `for-slack-bot.yml` спецификации.

Сохраните изменения.

# Шаг 5.3. Подписка на события в Slack

Перейдите в панель управления вашим Slack workspace — https://api.slack.com/ выберете созданное вами приложение `ServerlessBotApp`. В секции `Event Subscriptions` передвиньте ползунок `Enable Events` в положение `on`.

Вставьте адрес вашего API Gateway в поле `Request URL` дождитесь появления `Verified`.

В секции `Subscribe to bot events` на той же странице нажмите на кнопку `Add Bot User Event`
выберете `message.im`.

## Видео

https://youtu.be/YUCPVMaDwEw